{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"polars-labrodq-extension Documentation","text":"<p>Welcome to the official docs for the Polars DQ extension.</p>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#installation","title":"Installation","text":"<pre><code>pip install polars-labrodq-extension\n</code></pre>"},{"location":"api/CheckConfig/","title":"Check Config","text":""},{"location":"api/CheckConfig/#polars_labrodq_extension.config.models.CheckConfig","title":"<code>polars_labrodq_extension.config.models.CheckConfig</code>  <code>dataclass</code>","text":"Source code in <code>src/polars_labrodq_extension/config/models.py</code> <pre><code>@dataclass\nclass CheckConfig:\n    name: str\n    type: str\n    column: str\n    level: str = \"error\"\n    params: dict[str, Any] = field(default_factory=dict)\n\n    def to_check_def(self) -&gt; CheckDef:\n        return CheckDef(\n            name=self.name,\n            type=self.type,\n            column=self.column,\n            level=Severity.from_str(self.level),\n            params=self.params or None,\n        )\n</code></pre>"},{"location":"api/CheckConfig/#polars_labrodq_extension.config.models.CheckConfig.column","title":"<code>column</code>  <code>instance-attribute</code>","text":""},{"location":"api/CheckConfig/#polars_labrodq_extension.config.models.CheckConfig.level","title":"<code>level = 'error'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"api/CheckConfig/#polars_labrodq_extension.config.models.CheckConfig.name","title":"<code>name</code>  <code>instance-attribute</code>","text":""},{"location":"api/CheckConfig/#polars_labrodq_extension.config.models.CheckConfig.params","title":"<code>params = field(default_factory=dict)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"api/CheckConfig/#polars_labrodq_extension.config.models.CheckConfig.type","title":"<code>type</code>  <code>instance-attribute</code>","text":""},{"location":"api/CheckConfig/#polars_labrodq_extension.config.models.CheckConfig.to_check_def","title":"<code>to_check_def()</code>","text":"Source code in <code>src/polars_labrodq_extension/config/models.py</code> <pre><code>def to_check_def(self) -&gt; CheckDef:\n    return CheckDef(\n        name=self.name,\n        type=self.type,\n        column=self.column,\n        level=Severity.from_str(self.level),\n        params=self.params or None,\n    )\n</code></pre>"},{"location":"api/DQConfig/","title":"DQ Config","text":""},{"location":"api/DQConfig/#polars_labrodq_extension.config.models.DQConfig","title":"<code>polars_labrodq_extension.config.models.DQConfig</code>  <code>dataclass</code>","text":"Source code in <code>src/polars_labrodq_extension/config/models.py</code> <pre><code>@dataclass\nclass DQConfig:\n    dataset: str | None\n    checks: List[CheckConfig]\n\n    def to_checks(self) -&gt; List[CheckDef]:\n        return [c.to_check_def() for c in self.checks]\n</code></pre>"},{"location":"api/DQConfig/#polars_labrodq_extension.config.models.DQConfig.checks","title":"<code>checks</code>  <code>instance-attribute</code>","text":""},{"location":"api/DQConfig/#polars_labrodq_extension.config.models.DQConfig.dataset","title":"<code>dataset</code>  <code>instance-attribute</code>","text":""},{"location":"api/DQConfig/#polars_labrodq_extension.config.models.DQConfig.to_checks","title":"<code>to_checks()</code>","text":"Source code in <code>src/polars_labrodq_extension/config/models.py</code> <pre><code>def to_checks(self) -&gt; List[CheckDef]:\n    return [c.to_check_def() for c in self.checks]\n</code></pre>"},{"location":"api/DataFrameDQNamespace/","title":"Core","text":""},{"location":"api/DataFrameDQNamespace/#polars_labrodq_extension.polars_ns.dataframe.DataFrameDQNamespace","title":"<code>polars_labrodq_extension.polars_ns.dataframe.DataFrameDQNamespace</code>","text":"<p>Polars DataFrame namespace for data-quality checks.</p> <p>After importing this module (or labrodq that imports it), every <code>pl.DataFrame</code> instance will have a <code>.ldq</code> property:</p> <pre><code>df.ldq.run_checks(...)\ndf.ldq.run_yaml(\"dq/test.yml\")\ndf.ldq.quality_report_yaml(\"dq/test.yml\")\n</code></pre> <p>This is a minimal MVP implementation.</p> Source code in <code>src/polars_labrodq_extension/polars_ns/dataframe.py</code> <pre><code>@pl.api.register_dataframe_namespace(\"ldq\")\nclass DataFrameDQNamespace:\n    \"\"\"\n    Polars DataFrame namespace for data-quality checks.\n\n    After importing this module (or labrodq that imports it),\n    every `pl.DataFrame` instance will have a `.ldq` property:\n\n        df.ldq.run_checks(...)\n        df.ldq.run_yaml(\"dq/test.yml\")\n        df.ldq.quality_report_yaml(\"dq/test.yml\")\n\n    This is a minimal MVP implementation.\n    \"\"\"\n\n    def __init__(self, df: pl.DataFrame) -&gt; None:\n        self._df: pl.DataFrame = df\n\n    # -------- Public API --------\n\n    def run_checks(self, checks: Iterable[CheckDef]) -&gt; List[CheckResult]:\n        results: List[CheckResult] = []\n\n        for check in checks:\n            if check.type == \"not_null\":\n                result = self._eval_not_null(check)\n            elif check.type == \"max_null_ratio\":\n                result = self._eval_max_null_ratio(check)\n            else:\n                msg = f\"Unsupported check type: {check.type!r}\"\n                result = CheckResult(\n                    name=check.name,\n                    type=check.type,\n                    column=check.column,\n                    level=check.level,\n                    passed=False,\n                    message=msg,\n                    details={},\n                )\n            results.append(result)\n\n        return results\n\n    def quality_report(self, checks: Iterable[CheckDef]) -&gt; pl.DataFrame:\n        \"\"\"\n        Run checks and return a tabular Polars DataFrame with results.\n        \"\"\"\n        results = self.run_checks(checks)\n\n        return pl.DataFrame(\n            {\n                \"check\": [r.name for r in results],\n                \"type\": [r.type for r in results],\n                \"column\": [r.column for r in results],\n                \"level\": [r.level.value for r in results],\n                \"passed\": [r.passed for r in results],\n                \"message\": [r.message for r in results],\n            }\n        )\n\n    # --- YAML helpers ---\n\n    def run_yaml(self, path: str) -&gt; List[CheckResult]:\n        \"\"\"\n        Load checks from a YAML file and execute them.\n        \"\"\"\n        checks = load_checks_from_yaml(path)\n        return self.run_checks(checks)\n\n    def quality_report_yaml(self, path: str) -&gt; pl.DataFrame:\n        \"\"\"\n        Shortcut: load checks from YAML and return a quality report as DataFrame.\n        \"\"\"\n        checks = load_checks_from_yaml(path)\n        return self.quality_report(checks)\n\n    # -------- Internal helpers for concrete check types --------\n\n    def _eval_not_null(self, check: CheckDef) -&gt; CheckResult:\n        col = check.column\n        if col not in self._df.columns:\n            msg = f\"Column {col!r} not found\"\n            return CheckResult(\n                name=check.name,\n                type=check.type,\n                column=col,\n                level=check.level,\n                passed=False,\n                message=msg,\n                details={\"column_exists\": False},\n            )\n\n        null_count = self._df[col].null_count()\n        passed = null_count == 0\n\n        if passed:\n            msg = f\"Column {col!r} has no nulls\"\n        else:\n            msg = f\"Column {col!r} has {null_count} null values\"\n\n        return CheckResult(\n            name=check.name,\n            type=check.type,\n            column=col,\n            level=check.level,\n            passed=passed,\n            message=msg,\n            details={\n                \"null_count\": null_count,\n                \"row_count\": self._df.height,\n                \"null_ratio\": (\n                    null_count / self._df.height if self._df.height &gt; 0 else None\n                ),\n            },\n        )\n\n    def _eval_max_null_ratio(self, check: CheckDef) -&gt; CheckResult:\n        col = check.column\n        params = check.params or {}\n        threshold = float(params.get(\"threshold\", 0.0))\n\n        if col not in self._df.columns:\n            msg = f\"Column {col!r} not found\"\n            return CheckResult(\n                name=check.name,\n                type=check.type,\n                column=col,\n                level=check.level,\n                passed=False,\n                message=msg,\n                details={\"column_exists\": False, \"threshold\": threshold},\n            )\n\n        row_count = self._df.height\n        null_count = self._df[col].null_count()\n        null_ratio = null_count / row_count if row_count &gt; 0 else 0.0\n\n        passed = null_ratio &lt;= threshold\n\n        if passed:\n            msg = (\n                f\"Null ratio for column {col!r} is {null_ratio:.4f} \"\n                f\"(&lt;= {threshold:.4f})\"\n            )\n        else:\n            msg = (\n                f\"Null ratio for column {col!r} is {null_ratio:.4f} \"\n                f\"(&gt; {threshold:.4f})\"\n            )\n\n        return CheckResult(\n            name=check.name,\n            type=check.type,\n            column=col,\n            level=check.level,\n            passed=passed,\n            message=msg,\n            details={\n                \"row_count\": row_count,\n                \"null_count\": null_count,\n                \"null_ratio\": null_ratio,\n                \"threshold\": threshold,\n            },\n        )\n</code></pre>"},{"location":"api/DataFrameDQNamespace/#polars_labrodq_extension.polars_ns.dataframe.DataFrameDQNamespace.quality_report","title":"<code>quality_report(checks)</code>","text":"<p>Run checks and return a tabular Polars DataFrame with results.</p> Source code in <code>src/polars_labrodq_extension/polars_ns/dataframe.py</code> <pre><code>def quality_report(self, checks: Iterable[CheckDef]) -&gt; pl.DataFrame:\n    \"\"\"\n    Run checks and return a tabular Polars DataFrame with results.\n    \"\"\"\n    results = self.run_checks(checks)\n\n    return pl.DataFrame(\n        {\n            \"check\": [r.name for r in results],\n            \"type\": [r.type for r in results],\n            \"column\": [r.column for r in results],\n            \"level\": [r.level.value for r in results],\n            \"passed\": [r.passed for r in results],\n            \"message\": [r.message for r in results],\n        }\n    )\n</code></pre>"},{"location":"api/DataFrameDQNamespace/#polars_labrodq_extension.polars_ns.dataframe.DataFrameDQNamespace.quality_report_yaml","title":"<code>quality_report_yaml(path)</code>","text":"<p>Shortcut: load checks from YAML and return a quality report as DataFrame.</p> Source code in <code>src/polars_labrodq_extension/polars_ns/dataframe.py</code> <pre><code>def quality_report_yaml(self, path: str) -&gt; pl.DataFrame:\n    \"\"\"\n    Shortcut: load checks from YAML and return a quality report as DataFrame.\n    \"\"\"\n    checks = load_checks_from_yaml(path)\n    return self.quality_report(checks)\n</code></pre>"},{"location":"api/DataFrameDQNamespace/#polars_labrodq_extension.polars_ns.dataframe.DataFrameDQNamespace.run_checks","title":"<code>run_checks(checks)</code>","text":"Source code in <code>src/polars_labrodq_extension/polars_ns/dataframe.py</code> <pre><code>def run_checks(self, checks: Iterable[CheckDef]) -&gt; List[CheckResult]:\n    results: List[CheckResult] = []\n\n    for check in checks:\n        if check.type == \"not_null\":\n            result = self._eval_not_null(check)\n        elif check.type == \"max_null_ratio\":\n            result = self._eval_max_null_ratio(check)\n        else:\n            msg = f\"Unsupported check type: {check.type!r}\"\n            result = CheckResult(\n                name=check.name,\n                type=check.type,\n                column=check.column,\n                level=check.level,\n                passed=False,\n                message=msg,\n                details={},\n            )\n        results.append(result)\n\n    return results\n</code></pre>"},{"location":"api/DataFrameDQNamespace/#polars_labrodq_extension.polars_ns.dataframe.DataFrameDQNamespace.run_yaml","title":"<code>run_yaml(path)</code>","text":"<p>Load checks from a YAML file and execute them.</p> Source code in <code>src/polars_labrodq_extension/polars_ns/dataframe.py</code> <pre><code>def run_yaml(self, path: str) -&gt; List[CheckResult]:\n    \"\"\"\n    Load checks from a YAML file and execute them.\n    \"\"\"\n    checks = load_checks_from_yaml(path)\n    return self.run_checks(checks)\n</code></pre>"}]}